x-challenge:
  name: "Blind Trust"
  description: |
    # Blind Trust

    üõ∞Ô∏è A flawed deployment. A layered defense. Four secrets buried in static ‚Äî only the bold can decrypt the chaos.

    **NICE Work Roles**
    * [Vulnerability Analysis](https://niccs.cisa.gov/tools/nice-framework)
    * [Exploitation Analysis](https://niccs.cisa.gov/tools/nice-framework)


    **NICE Tasks**
    * [T0280](https://niccs.cisa.gov/tools/nice-framework): Identify and validate vulnerabilities in the system	
    * [T0653](https://niccs.cisa.gov/tools/nice-framework): Identify and recommend methods for exploiting target systems	
    * [T0269](https://niccs.cisa.gov/tools/nice-framework): Conduct exploitation of targets using identified vulnerabilities	
    * [T0650](https://niccs.cisa.gov/tools/nice-framework): Conduct target and technical analysis of systems and vulnerabilities	

    ## Background
    
    üõ∞Ô∏è In the wake of a major whistle blower leak, a shadowy government contractor ‚Äî Nebula Dynamics ‚Äî accidentally deployed a test version of its internal document processing system to a public-facing server. Intelligence suggests it parses sensitive XML-based threat reports. You're tasked with infiltrating the system and extracting the classified tokens buried deep within the code.

    ## Getting Started

    The target website can be found at `http://nebula:5000`. Begin your hunt - enumerate the application and find its secrets (tokens).

    **Token Format**  

    ```text
    e.g. ‚úÖ TOKEN1: PCCC{BLT-alphanumeric_string}
    ```

    **Discovery Phase Operations**
    Everything is not as it seems. Thoroughly investigate all presented functionality to determine the vulnerabilities in the Telemetry system.

    ## Objectives
    * Inspect the site's XML-driven components for unusual behavior.
    * Discover indirect access methods through lesser-known routes.
    * Demonstrate control over backend communications by crafting non-standard HTTP payloads.
    * Collect all four embedded access tokens hidden across the app‚Äôs layers.

    ## System and Tool Credentials

    |system/tool|location|
    |-----------|--------|
    |Nebula|`http://nebula:5000`|

    ## Note

    You do not need root access to the server to complete this challenge. Tokens are awarded through completion of the objectives.

  icon: "TbUser"
  summary: "üõ∞Ô∏è A flawed deployment. A layered defense. Four secrets buried in static ‚Äî only the bold can decrypt the chaos."
  variables:
    token1:
      template: "fake.bothify('PCCC{BLT-?#?#??}')"
      default: &token1 "PCCC{BLT-111111}"
    token2:
      template: "fake.bothify('PCCC{BLT-?#?#??}')"
      default: &token2 "PCCC{BLT-222222}"
    token3:
      template: "fake.bothify('PCCC{BLT-?#?#??}')"
      default: &token3 "PCCC{BLT-333333}"
    token4:
      template: "fake.bothify('PCCC{BLT-?#?#??}')"
      default: &token4 "PCCC{BLT-444444}"      

  questions:
    - name: Token 1 - All About Telemetry
      body: Exploit an XML parsing vulnerability in the telemetry submission interface to retrieve sensitive internal data from /etc/passwd.
      answer: *token1
      placeholder: PCCC{XXX-YYYYYY}
      points: 850
      max_attempts: 3
    
    - name: Token 2 - The Submission
      body: Submit a log to the Production system using the correct format to retrieve this token. All incorrect submissions will be simply logged without token issuance.
      answer: *token2
      placeholder: PCCC{XXX-YYYYYY}
      points: 850
      max_attempts: 3
    
    - name: Token 3 - SSRF
      body: Successfully send a report in the correct format using the /report/render endpoint (SSRF via XML).
      answer: *token3
      placeholder: PCCC{XXX-YYYYYY}
      points: 854
      max_attempts: 3  
    
    - name: Token 4 - Debug Mode
      body: Determine a way to enable Debug Mode and access the '/internal/notes' endpoint.
      placeholder: PCCC{XXX-YYYYYY}
      answer: *token4
      points: 854
      max_attempts: 3

services:
  blind_trust:
    build:
      context: .
      dockerfile: Dockerfile
    environment:
      TOKEN1: *token1
      TOKEN2: *token2
      TOKEN3: *token3
      TOKEN4: *token4
    hostname: nebula
    networks:
      - competitor_net

networks:
  competitor_net:
    internal: true
